# Microsoft CMMC Enclave - Terraform Variables Example
# Copy this file to terraform.tfvars and customize for your environment

# Project Configuration
project_name    = "cmmc-enclave"
environment     = "prod"
resource_owner  = "Security-Team"
cost_center     = "IT-Security-Operations"

# Azure Configuration
azure_environment = "AzureUSGovernment"
azure_region      = "USGov Virginia"

# Security Classification
security_classification = "CUI"

# Network Configuration
vnet_address_space       = "10.200.0.0/16"
management_subnet_prefix = "10.200.1.0/24"
workload_subnet_prefix   = "10.200.2.0/24" 
data_subnet_prefix       = "10.200.3.0/24"
gateway_subnet_prefix    = "10.200.4.0/24"
bastion_subnet_prefix    = "10.200.5.0/24"

# CMMC Compliance Configuration
cmmc_level               = 2
nist_baseline           = "Rev2"
enable_fedramp_controls = true

# Data Classification Configuration
cui_categories = [
  "CUI Basic",
  "CUI Specified",
  "Export Controlled Technical Data",
  "Federal Tax Information",
  "ITAR"
]

sensitivity_labels = [
  "Public",
  "Internal", 
  "General",
  "Confidential",
  "Highly Confidential",
  "CUI",
  "CUI//SP"
]

# Logging and Audit Configuration
log_retention_days = 365

audit_log_categories = [
  "AuditEvent",
  "Authentication",
  "Authorization", 
  "DataAccess",
  "PolicyChange",
  "PrivilegeEscalation",
  "SystemEvents"
]

# Database Configuration
sql_admin_username      = "cmmc-admin"
sql_aad_admin_login    = "CMMC-SQL-Admin"
sql_aad_admin_object_id = "12345678-1234-1234-1234-123456789012"  # Replace with actual Azure AD group object ID
database_max_size_gb    = 250
database_sku_name      = "S3"

# Storage Configuration
blob_retention_days           = 90
container_retention_days      = 90
enable_customer_managed_keys  = true

# Virtual Machine Configuration
vm_size                = "Standard_D4s_v3"
vm_admin_username      = "cmmc-admin"
enable_vm_auto_patching = true

# Security Configuration
security_alert_emails = [
  "security-team@yourcompany.gov",
  "ciso@yourcompany.gov"
]
threat_detection_retention_days     = 90
enable_advanced_threat_protection   = true

# Backup and Recovery Configuration
backup_retention_days       = 2555  # 7 years for CMMC compliance
enable_point_in_time_restore = true

# Monitoring Configuration
enable_security_center      = true
security_center_pricing_tier = "Standard"
enable_sentinel             = true

# Compliance Scanning Configuration
vulnerability_assessment_enabled = true
compliance_scan_schedule         = "0 2 * * *"  # Daily at 2 AM

# Network Security Configuration
enable_ddos_protection = true
allowed_source_ip_ranges = [
  "10.0.0.0/8",      # Private network ranges
  "172.16.0.0/12",   # Private network ranges
  "192.168.0.0/16"   # Private network ranges
]

# Identity and Access Configuration
enable_privileged_identity_management = true
mfa_required_for_admins              = true

password_policy_complexity = {
  minimum_length              = 14
  require_uppercase          = true
  require_lowercase          = true  
  require_numbers            = true
  require_special_characters = true
  password_history_count     = 24
  max_password_age_days      = 60
}

# Data Loss Prevention Configuration
dlp_policies = [
  {
    name        = "CUI Protection Policy"
    description = "Prevent unauthorized sharing of CUI data"
    priority    = 1
    locations   = ["Exchange", "SharePoint", "OneDrive", "Teams"]
    rules = [
      {
        name       = "Block CUI External Sharing"
        conditions = ["Content contains CUI", "Shared externally"]
        actions    = ["Block", "Notify user", "Generate incident"]
      }
    ]
  }
]

# Information Protection Configuration  
information_protection_labels = [
  {
    name         = "CUI"
    description  = "Controlled Unclassified Information"
    color        = "#FF0000"
    priority     = 90
    encryption   = true
    watermarking = true
    conditions   = ["Contains CUI", "NIST SP 800-171"]
  },
  {
    name         = "CUI//SP"
    description  = "CUI with Specified Handling"
    color        = "#8B0000" 
    priority     = 95
    encryption   = true
    watermarking = true
    conditions   = ["Contains CUI SP", "DFARS"]
  }
]

# Incident Response Configuration
incident_response_team_emails = [
  "incident-response@yourcompany.gov",
  "security-operations@yourcompany.gov"
]

security_incident_severity_levels = {
  "Critical" = {
    response_time_hours = 1
    escalation_required = true
    notification_list   = ["CISO", "Security-Team", "Incident-Response"]
  }
  "High" = {
    response_time_hours = 4
    escalation_required = true
    notification_list   = ["Security-Team", "Incident-Response"]
  }
  "Medium" = {
    response_time_hours = 24
    escalation_required = false
    notification_list   = ["Security-Team"]
  }
  "Low" = {
    response_time_hours = 72
    escalation_required = false
    notification_list   = ["Security-Team"]
  }
}

# Disaster Recovery Configuration
enable_cross_region_replication = true
dr_region                      = "USGov Texas"
rto_hours                      = 24
rpo_hours                      = 4

# Cost Management Configuration
budget_amount           = 50000  # Monthly budget in USD
budget_alert_thresholds = [50, 80, 100]
cost_optimization_enabled = true

# Example Environment-Specific Overrides

# Development Environment Example
# Uncomment and modify for development environment
# environment = "dev"
# vm_size = "Standard_B2s"
# database_sku_name = "S0"
# budget_amount = 5000
# enable_cross_region_replication = false
# backup_retention_days = 365

# Test Environment Example  
# Uncomment and modify for test environment
# environment = "test"
# vm_size = "Standard_D2s_v3"
# database_sku_name = "S1"  
# budget_amount = 15000
# log_retention_days = 90
# threat_detection_retention_days = 30

# Production Environment Example (Current Configuration)
# This configuration is suitable for production CMMC environments
# All security controls enabled with maximum retention periods
# High-performance SKUs for production workloads
# Comprehensive monitoring and alerting
# Full disaster recovery capabilities

# Regional Considerations
# USGov Virginia - Primary region for most DoD contractors
# USGov Texas - Secondary region for disaster recovery
# USGov Arizona - Alternative region for specific compliance requirements
# USGov Iowa - Additional region for distributed workloads

# Sizing Guidelines
# Small Environment (1-100 users):
#   vm_size = "Standard_D2s_v3"
#   database_sku_name = "S2"
#   budget_amount = 10000

# Medium Environment (100-500 users):
#   vm_size = "Standard_D4s_v3"  
#   database_sku_name = "S3"
#   budget_amount = 25000

# Large Environment (500+ users):
#   vm_size = "Standard_D8s_v3"
#   database_sku_name = "P2"
#   budget_amount = 50000+

# Special Compliance Requirements

# ITAR Compliance Additional Settings
# security_classification = "CUI//SP-ITAR"
# cui_categories = ["ITAR", "Export Controlled Technical Data"]
# enable_advanced_threat_protection = true
# log_retention_days = 2555  # 7 years

# Federal Tax Information (FTI) Additional Settings
# security_classification = "CUI//SP-FTI"
# cui_categories = ["Federal Tax Information"]
# password_policy_complexity.minimum_length = 15
# backup_retention_days = 2555  # 7 years

# Notes:
# 1. Replace placeholder values with your actual organizational information
# 2. Ensure Object IDs correspond to actual Azure AD groups in your tenant
# 3. Validate IP address ranges match your network topology
# 4. Review and adjust retention periods based on your compliance requirements
# 5. Test configuration in development environment before production deployment
# 6. Regularly review and update security configurations
# 7. Coordinate with Microsoft Federal Services for optimization recommendations