# Dell PowerEdge CI Infrastructure - Test Inventory
# EO Framework - Dell DevOps Solutions
# Generated from configuration.csv - Test environment (reduced scale)

---
all:
  vars:
    # Ansible connection settings
    ansible_connection: ssh
    ansible_user: ansible
    ansible_become: true
    ansible_python_interpreter: /usr/bin/python3

    # Environment
    environment: test
    solution_name: poweredge-ci-infrastructure
    solution_abbr: pci

  children:
    #=========================================================================
    # GITLAB SERVERS (Single server for test)
    #=========================================================================
    gitlab_servers:
      hosts:
        gitlab-test-01:
          ansible_host: 10.21.0.11
          gitlab_role: standalone
          description: "GitLab Test Server - PowerEdge R650"
      vars:
        server_role: gitlab
        server_model: PowerEdge-R650
        gitlab_version: "16.8-ee"
        gitlab_ha_enabled: false

    #=========================================================================
    # DATABASE SERVERS (Single instance)
    #=========================================================================
    database_servers:
      hosts:
        gitlab-db-test-01:
          ansible_host: 10.21.0.21
          db_role: standalone
          description: "GitLab Database Test - PostgreSQL 15"
      vars:
        server_role: database
        postgres_version: "15"
        patroni_enabled: false

    #=========================================================================
    # BUILD AGENTS (Reduced scale - 2 agents)
    #=========================================================================
    build_agents:
      hosts:
        build-agent-test-01:
          ansible_host: 10.21.0.31
          agent_id: 1
          runner_count: 2
          description: "Build Agent Test 01 - PowerEdge R650"
        build-agent-test-02:
          ansible_host: 10.21.0.32
          agent_id: 2
          runner_count: 2
          description: "Build Agent Test 02 - PowerEdge R650"
      vars:
        server_role: build_agent
        server_model: PowerEdge-R650
        cpu_model: Intel-Xeon-Gold-6338
        memory_gb: 128
        storage_tb: 1
        docker_version: "24.0"
        runner_executor: docker

    #=========================================================================
    # ARTIFACT REPOSITORY
    #=========================================================================
    artifactory_servers:
      hosts:
        artifactory-test-01:
          ansible_host: 10.21.0.41
          description: "JFrog Artifactory Test - PowerEdge R650"
      vars:
        server_role: artifactory
        artifactory_version: "7.x-pro"
        artifact_storage_tb: 5

    #=========================================================================
    # MONITORING SERVERS
    #=========================================================================
    monitoring_servers:
      hosts:
        monitoring-test-01:
          ansible_host: 10.21.0.51
          description: "Monitoring Test - PowerEdge R650"
      vars:
        server_role: monitoring
        monitoring_solution: prometheus-grafana

    #=========================================================================
    # LOGICAL GROUPS
    #=========================================================================
    poweredge_servers:
      children:
        gitlab_servers:
        database_servers:
        build_agents:
        artifactory_servers:
        monitoring_servers:

    docker_hosts:
      children:
        build_agents:

    gitlab_infrastructure:
      children:
        gitlab_servers:
        database_servers:
