# Dell PowerEdge CI Infrastructure - Production Inventory
# EO Framework - Dell DevOps Solutions
# Generated from configuration.csv

---
all:
  vars:
    # Ansible connection settings
    ansible_connection: ssh
    ansible_user: ansible
    ansible_become: true
    ansible_python_interpreter: /usr/bin/python3

    # Environment
    environment: production
    solution_name: poweredge-ci-infrastructure
    solution_abbr: pci

  children:
    #=========================================================================
    # GITLAB SERVERS
    #=========================================================================
    gitlab_servers:
      hosts:
        gitlab-01:
          ansible_host: 10.20.0.11
          gitlab_role: primary
          description: "GitLab Primary Server - PowerEdge R650"
        gitlab-02:
          ansible_host: 10.20.0.12
          gitlab_role: secondary
          description: "GitLab Secondary Server - PowerEdge R650"
      vars:
        server_role: gitlab
        server_model: PowerEdge-R650
        gitlab_version: "16.8-ee"
        gitlab_ha_enabled: true

    #=========================================================================
    # DATABASE SERVERS
    #=========================================================================
    database_servers:
      hosts:
        gitlab-db-01:
          ansible_host: 10.20.0.21
          db_role: primary
          patroni_cluster_name: gitlab-patroni
          description: "GitLab Database - PostgreSQL 15"
        gitlab-db-02:
          ansible_host: 10.20.0.22
          db_role: replica
          patroni_cluster_name: gitlab-patroni
          description: "GitLab Database Replica - PostgreSQL 15"
      vars:
        server_role: database
        postgres_version: "15"
        patroni_enabled: true

    #=========================================================================
    # BUILD AGENTS (PowerEdge R650)
    #=========================================================================
    build_agents:
      hosts:
        build-agent-01:
          ansible_host: 10.20.0.31
          agent_id: 1
          runner_count: 3
          description: "Build Agent 01 - PowerEdge R650"
        build-agent-02:
          ansible_host: 10.20.0.32
          agent_id: 2
          runner_count: 3
          description: "Build Agent 02 - PowerEdge R650"
        build-agent-03:
          ansible_host: 10.20.0.33
          agent_id: 3
          runner_count: 3
          description: "Build Agent 03 - PowerEdge R650"
        build-agent-04:
          ansible_host: 10.20.0.34
          agent_id: 4
          runner_count: 3
          description: "Build Agent 04 - PowerEdge R650"
        build-agent-05:
          ansible_host: 10.20.0.35
          agent_id: 5
          runner_count: 3
          description: "Build Agent 05 - PowerEdge R650"
        build-agent-06:
          ansible_host: 10.20.0.36
          agent_id: 6
          runner_count: 3
          description: "Build Agent 06 - PowerEdge R650"
        build-agent-07:
          ansible_host: 10.20.0.37
          agent_id: 7
          runner_count: 3
          description: "Build Agent 07 - PowerEdge R650"
        build-agent-08:
          ansible_host: 10.20.0.38
          agent_id: 8
          runner_count: 3
          description: "Build Agent 08 - PowerEdge R650"
      vars:
        server_role: build_agent
        server_model: PowerEdge-R650
        cpu_model: Intel-Xeon-Gold-6338
        memory_gb: 256
        storage_tb: 2
        docker_version: "24.0"
        runner_executor: docker

    #=========================================================================
    # ARTIFACT REPOSITORY
    #=========================================================================
    artifactory_servers:
      hosts:
        artifactory-01:
          ansible_host: 10.20.0.41
          description: "JFrog Artifactory Server - PowerEdge R650"
      vars:
        server_role: artifactory
        artifactory_version: "7.x-pro"
        artifact_storage_tb: 20

    #=========================================================================
    # MONITORING SERVERS
    #=========================================================================
    monitoring_servers:
      hosts:
        monitoring-01:
          ansible_host: 10.20.0.51
          description: "Prometheus/Grafana Monitoring - PowerEdge R650"
      vars:
        server_role: monitoring
        monitoring_solution: prometheus-grafana

    #=========================================================================
    # LOGICAL GROUPS
    #=========================================================================
    poweredge_servers:
      children:
        gitlab_servers:
        database_servers:
        build_agents:
        artifactory_servers:
        monitoring_servers:

    docker_hosts:
      children:
        build_agents:

    gitlab_infrastructure:
      children:
        gitlab_servers:
        database_servers:
