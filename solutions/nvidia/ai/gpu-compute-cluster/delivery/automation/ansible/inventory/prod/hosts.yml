#------------------------------------------------------------------------------
# NVIDIA GPU Compute Cluster - Production Inventory
#------------------------------------------------------------------------------
# Environment: Production
# Values are populated from group_vars/all.yml (generated from configuration.csv)
#------------------------------------------------------------------------------

all:
  vars:
    environment: prod

  children:
    #--------------------------------------------------------------------------
    # Management Nodes
    #--------------------------------------------------------------------------
    management:
      children:
        slurm_controllers:
          hosts:
            slurm-controller-01:
              ansible_host: "{{ slurm.controller_ip }}"
              slurm_role: primary
            slurm-controller-02:
              ansible_host: "{{ slurm.controller_backup_ip }}"
              slurm_role: backup
          vars:
            ansible_connection: ssh
            ansible_user: "{{ security.ssh_user | default('gpuadmin') }}"
            ansible_become: yes

    #--------------------------------------------------------------------------
    # GPU Compute Nodes
    #--------------------------------------------------------------------------
    gpu_nodes:
      hosts:
        # Production: 16 GPU nodes with 4x A100 each
        gpu-node-01:
          ansible_host: 10.100.0.101
          gpu_count: 4
        gpu-node-02:
          ansible_host: 10.100.0.102
          gpu_count: 4
        gpu-node-03:
          ansible_host: 10.100.0.103
          gpu_count: 4
        gpu-node-04:
          ansible_host: 10.100.0.104
          gpu_count: 4
        gpu-node-05:
          ansible_host: 10.100.0.105
          gpu_count: 4
        gpu-node-06:
          ansible_host: 10.100.0.106
          gpu_count: 4
        gpu-node-07:
          ansible_host: 10.100.0.107
          gpu_count: 4
        gpu-node-08:
          ansible_host: 10.100.0.108
          gpu_count: 4
        gpu-node-09:
          ansible_host: 10.100.0.109
          gpu_count: 4
        gpu-node-10:
          ansible_host: 10.100.0.110
          gpu_count: 4
        gpu-node-11:
          ansible_host: 10.100.0.111
          gpu_count: 4
        gpu-node-12:
          ansible_host: 10.100.0.112
          gpu_count: 4
        gpu-node-13:
          ansible_host: 10.100.0.113
          gpu_count: 4
        gpu-node-14:
          ansible_host: 10.100.0.114
          gpu_count: 4
        gpu-node-15:
          ansible_host: 10.100.0.115
          gpu_count: 4
        gpu-node-16:
          ansible_host: 10.100.0.116
          gpu_count: 4
      vars:
        ansible_connection: ssh
        ansible_user: "{{ security.ssh_user | default('gpuadmin') }}"
        ansible_become: yes
        ansible_network_os: linux

    #--------------------------------------------------------------------------
    # Infrastructure Services
    #--------------------------------------------------------------------------
    monitoring:
      hosts:
        prometheus-server:
          ansible_host: "{{ monitoring.prometheus_server_ip }}"
        grafana-server:
          ansible_host: "{{ monitoring.grafana_server_ip }}"
      vars:
        ansible_connection: ssh
        ansible_user: "{{ security.ssh_user | default('svcadmin') }}"
        ansible_become: yes

    #--------------------------------------------------------------------------
    # Local Execution (for API calls)
    #--------------------------------------------------------------------------
    localhost:
      hosts:
        localhost:
          ansible_connection: local
          ansible_python_interpreter: "{{ ansible_playbook_python }}"
